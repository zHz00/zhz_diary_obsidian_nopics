Shimmie как органайзер картинок
================================

   
 2013-02-28, 22:28   
   *Инструкция по кратчайшей установке и настройке Shimmie под Windows.*    
  [(читать дальше)](https://zHz00.diary.ru/p185851728.htm?index=1#linkmore185851728m1)      
  **Что такое Shimmie и зачем он нужен.**    
 У некоторых активных пользователей интернета рано или поздно накапливается большое число сохранённых изображений. Ориентироваться в этой куче становится довольно проблематично.   
 Shimmie -- движок интернет-галерей с картинками, который позволяет организовать вашу коллекцию изображений (при помощи тегов и пулов, об этом ниже). Несмотря на то, что Shimmie -- движок ИНТЕРНЕТ-галерей, никто не мешает поставить его себе на локальный компьютер (предварительно подняв локальный веб-сервер). Тогда Shimmie будет работать как локальный сайт. Только для вашего компьютера.   
  **Почему именно Shimmie?**    
 1. В отличие от бинарных органайзеров фотографий типа ACDSee, Shimmie бесплатен и обладает открытым исходным кодом, поэтому может быть допилен по месту. Кроме того, его исходный код не очень большой, написан он на php, а архитектура модульная.   
 2. Ещё есть digikam, но под Windows это вообще не вариант (тормозит, потому что тянет за собой KDE), хотя штука вроде крутая.   
 3. Вы получаете в распоряжение привычный (для некоторых) booru-интерфейс, как в  [http://chan.sankakucomplex.com](https://chan.sankakucomplex.com/?tags=rating%3Asafe)  или <http://gelbooru.com> .   
 4. Почему не gelbooru/moebooru? Они написаны на Ruby. Я не знаю, есть ли готовые установщики Ruby+веб-сервер, в Денвер-4 вроде обещали, но пока его нет. А для php+MySQL+веб-сервер установщик есть. Это облегчает процесс для неспециалистов.   
   
  **Требуемая квалификация:**    
 1. Средний пользователь компьютера. Надо уметь различать файлы и папки, сёрфить интернет, понимать, что такое сайт и веб-сервер.   
 2. Среднее знание английского языка. Можно обойтись и без этого, поскольку число выдаваемых Shimmie сообщений ограничено и их можно один раз перевести с другом-всезнайкой, а потом выучить.   
   
 Далее везде то, что в кавычках, следует искать (или писать) точно так же, буква в букву. Кавычки оставлять не следует.   
 Если хотите дополнительную защиту (или разнообразие) можно менять имена пользователей, пароли и т.д., но только если вы понимаете, что вы делаете и какие имя пользователя и пароль чему соответствуют.   
   
  **Часть 1. Установка.**    
 Итак, Shimmie. Shimmie работает как веб-сайт, поэтому вам понадобится веб-сервер. Кроме того, он написан на php, его тоже надо поставить. А ещё Shimmie использует базу данных, поэтому ещё нужен MySQL. Придётся ли всё это ставить отдельно? Нет! Есть сборка.   
 Примечание. Если у вас уже стоит какой-либо веб-сервер (работающий) или MySQL, но вам, возможно, придётся не пользоваться этой инструкцией или в некоторых местах не следовать ей, а придумать свой образ действий. Но если вы те штуки поставили (запустили) сами, то, скорее всего, справитесь самостоятельно и без этой инструкции.   
   
 1. Качаем Денвер-3 (8.5 мегабайт):   
 <http://www.denwer.ru/>   
 Если вам претит идея оставлять им свой адрес почты, чтобы скачать, поищите гуглом. С версией от 16 сентября 2012 года Shimmie работает, я проверял.   
 2. Запускаем скачанный файл.   
 Закрываем открывшийся в результате запуска браузер.   
 Установка проходит в командной строке. Отвечаем на 4 вопроса (а также делаем несколько дополнительных подтверждений, их я здесь не указываю -- читайте надписи на экране):   
 а) куда ставить? -- следует напечатать буквами имя папки, куда будете ставить (или нажать Enter для решения по умолчанию).   
 Учтите, все ваши картинки будут внутри этой папки, поэтому путь по-умолчанию "C:\WebServers\" следует выбирать только если на диске C: у вас много места. Иначе следует написать, например, "D:\WebServers\" (если на диске D места много). В любом случае, часть "WebServers" рекомендую оставить. Если папка уже существовало, что будет с тем, что в ней было, не знаю.   
 б) буква виртуального диска? -- Z, если свободна.   
 в) запускать ли автоматом? -- следует ответить 1 или 2.   
 Если вы собираетесь постоянно этой штукой пользоваться, отвечайте, чтобы запускалось автоматом (1).   
 г) создавать ли ярлыки? y (да) или n (нет)   
 Создайте на всякий случай.   
   
 Окошко браузера, которое откроется после установки, пока не трогаем.   
 3. Идём туда, куда указали ставить, находим там папку "usr". Дальше идём по папкам "local\php5\php.ini". Открываем этот файл Блокнотом.   
 Исправляем следующие строки (они в разных местах; то, что до знака равно, можно найти при помощи поиска -- Ctrl+F):   
 post\_max\_size = 0   
 upload\_max\_filesize = 0   
 4. Идём в папку home, которая внутри той, что мы выбрали при установке (то есть, поднимаемся выше относительно того, где были в пункте 3). Создаём в ней папку с именем "shimmie". Внутри создаём папку "www".   
 5. Идём на сайт Shimmie:   
 <http://code.shishnet.org/shimmie2/>   
 там нажимаем ссылку "browse source", в открывшемся окне GitHub кнопка -- "ZIP" с облачком.   
 Вот сразу адрес, по которому качать (1.6 мегабайта):   
 <https://github.com/shish/shimmie2/archive/master.zip>   
 Распаковываем архив в созданную нами в пункте 4 папку "www" так, чтобы "install.php" лежал в самом "www" а не в его подпапках.   
 6. Запускаем Денвер ярлыком с рабочего стола ("Start Denwer").   
 7. Возвращаемся к оставленному в шаге 2 окошку и внимательно читаем то, что там написано (и выполняем). По идее всё должно работать.   
 Открываем в браузере, как там написано, <http://localhost/> (можно по ссылке перейти).   
 Внизу страницу щёлкаем по ссылке:   
 "Заведение новых БД и пользователей MySQL"   
 В поле "Имя базы данных" напишите "shimmie", поле "Имя пользователя" заполнится автоматически, остальные поля не трогайте. Нажмите кнопку "Создать БД и пользователя". Убедись, что появилась надпись "База данных и новый пользователь заведены."   
 8. Открываем новую вкладку браузера, пишем в ней   
 <http://shimmie/>   
 Откроется установщик Shimmie. В поле "Username" пишем "shimmie", остальное не трогаем, нажимаем Go!   
 Через несколько секунд появится приветственное сообщение. Shimmie установлен!   
   
  **Часть 2. Настройка.**    
   
 1. Нажимаем ссылку "Create account", пишем имя "shimmie", пароль "shimmie" (два раза). Нажимаем кнопку "Create Account". Первый пользователь Shimmie по-умолчанию является администратором. Откроется ваш профиль.   
  *Мы создали пользователя.*  Поскольку Shimmie изначально  **интернет**  -галерея, она поддерживает многопользовательский режим.   
 2. Жмём слева ссылку "Board config". В поле "Max size per file:" пишем что-нибудь большое, соответствующее вашей самой большой картинке. Например, "100M". Жмём кнопку "Save settings" внизу страницы.   
  *Мы сделали так, что можно загружать большие картинки.*    
 3. Потом слева жмём ссылку "Extension Manager". Ставим галочки напротив "Admin Controls", "Bulk Add". И напротив чего-нибудь ещё, что пожелаете -- играться с настройками и расширениями можно долго.   
  *Мы открыли возможность добавлять целые папки картинок.*    
 Чтобы ей воспользоваться, нажимаем слева ссылку "Board Admin" и ищем там рамочку "Bulk Add". Вводим в текстовое поле имя локальной папки (например, "c:\downloads\porn\images\"), потом нажимаем "Add". Ждём некоторое время, потом появляется отчёт о том, что было добавлено, а что нет. Предупреждаю, что при добавке через "Bulk Add" имена файлов с иероглифами не поддерживаются. Имена с русскими буквами тоже. Имена папок тоже. Поддержку русских букв добавить можно, слегка поменяв исходники.  **Внимание! Проделывайте следующий абзац только если оно вам действительно нужно!**    
 Для этого откройте при помощи  [Notepad++](https://notepad-plus-plus.org/download/v6.3.html)  (  [ссылка на установщик](http://download.tuxfamily.org/notepadplus/6.3/npp.6.3.Installer.exe)  ) (почему именно его, долго об'яснять) файл "ext\bulk\_add\main.php" и после строчки номер 58 (там фигурная скобка закрывающаяся, а в предыдущей строке должно быть "throw new UploadException("File has no extension");") добавьте следующую строку:   
 $pathinfo['basename']=iconv("cp1251","utf-8",$pathinfo['basename']);   
   
 Примечание. Я указываю содержимое предыдущих строк, потому что с выходом новых версий номера строк могут измениться. Если в строках 57 и 58 будет не то, что я написал, найдите строки в этом файле по тексту, а не по номеру, и добавляйте после них.   
   
  *Первичная настройка Shimmie завершена.*    
 Теперь вы можете добавлять свои картинки как по одной (через блок "Upload" на главной странице), так и кучами. Старайтесь не добавлять одновременно более 500 изображений, так как это может привести к тому, что произойдёт ошибка таймаута (не важно, что это). Во время добавления папок на экран ничего не выводится. Надо просто ждать завершения.   
   
 Теперь вы можете устанавливать к своим картинкам теги и об'единять их в пулы.   
   
  **Тег**  (в Shimmie) -- текстовая метка к изображению, как либо характеризующая его.   
 Вы помните тот случай (или аналогичный), когда не знали, в какую папку положить демотиватор с анимешной девочкой -- в "Аниме" или в "Демотиваторы"? Теперь этих проблем нет. Вы можете поставить изображению оба тега. Тогда это изображение будет появляться при поиске и по тегу "Аниме" и по тегу "Демотиваторы". А если искать по обоим тегам сразу, будут отображены все демотиваторы с анимешными девочками, которые вы загрузили.   
   
  **Пул**  (в Shimmie) -- упорядоченный набор изображений с каким-либо именем. У вас есть мини-манга из шести листов? Заведите на неё пул (для этого надо включить расширение "Pools") и просматривайте её всегда в правильном порядке. Однако при большом количестве изображений в пуле их сортировка может превратиться в длительное занятие. Пулы отображаются в отдельном списке, однако сами картинки в пулах из поиска не пропадают и по-прежнему доступны. Прежде, чем добавлять картинки в пул, их надо загрузить в Shimmie.   
   
 Также вы можете искать не только по тегам, но и по более сложным критериям. Подробнее об этом написано в   
 <http://shimmie/index.php?q=/ext_doc/index/>   
   
   
  **FAQ**  (на самом деле мне не задали ни единого вопроса, я их все сам придумал)   
 Q. Что мне делать с уже добавленными файлами?   
 A. Удалите их. Теперь файлы расположены внутри Shimmie.   
   
 Q. Где теперь все мои картинки?   
 A. Они в папке ...\home\shimmie\www\images\. Там сколько-то двухбуквенных папок и в них куча файлов. Это ваши картинки. Имя картинки соответствует хэшу (  [подробнее про это](Sankaku%20Complex%20запрет%20прямых%20ссылок%20и%20борьба%20с%20ним)  ). Если к любому файлу добавить расширение .jpg, он откроется как картинка (не забудьте потом поменять расширение обратно, а то Shimmie не найдёт картинку).   
   
 Q. Я вижу свои картинки через браузер. Могут ли другие пользователи их увидеть, набрав у себя в адресной строке <http://shimmie/> или каким-либо другим способом?   
 A. Только если они сидят за вашим компьютером. Если Shimmie стоит под Денвером, он полностью локален, извне доступ к нему получить нельзя (точнее, можно, но вам придётся приложить много усилий, и сделать его доступным извне можете только вы сами).   
   
 Q. Можно ли защитить картинки от просмотра на локальном компьютере?   
 A. Есть два направления защиты:   
 1. Локальный доступ через папки: единственный способ защиты -- шифрование файловой системы, которое, начиная с Windows XP, есть в самой ОС. Процесс организации этого выходит за рамки статьи. Однако даже без шифрования ваши картинки найти тяжело -- они лежат в какой-то левой папке, да ещё без расширения и с непонятным названием. Тут надо  **знать**  , что ищешь, тогда можно найти.   
 2. Защита доступа через браузер. Это реализуемо и довольно просто. Зайдите в "Extension manager" и включите расширение "Image ratings" (не забудьте нажать после этого "Set Extensions"). После этого на странице "Board Config" появится раздел "Image ratings". Поставьте там "Anonymous": "Safe Only", "Users": "Safe Only" (и нажмите кнопку "Save settings"). Всё. Теперь незалогиненные пользователи будут видеть только те картинки, на которых вы явно укажете, что они "Safe" (безопасны). По-умолчанию картинки имеют рейтинг "Unknown" ("Unrated") и поэтому не отображаются. Кроме того, даже если потенциальный посетитель заригистрируется, ему будут показываться также только безопасные изображения. Только администраторы будут видеть всё (например, вы (: ). А регистрацию новых пользователей вообще можно отключить.   
 Примечание 1. На текущий момент есть способ обхода этого. В подробности я вдаваться не буду, опять-таки, об этом надо  **знать**  , чтобы воспользоваться.   
 Примечание 2. Пароль от пользователя (в профиле), разумеется, надо сменить. А то злоумышленники могут легко догадаться.   
   
 Q. Могу ли я достать обратно свои картинки?   
 A. Да, конечно. Но по одной. Открыли, сохранили. Чтобы заставить Shimmie выплёвывать картинки кучей, придётся его допиливать. Но в "Board Admin" есть кнопочка "Download all images". Попробуйте её. У меня она, правда, не работает. Кроме того, вы можете просто перекопировать папку images. Если вам нужно переехать на другой компьютер (переставить ОС), скопируйте всю папку WebServers. Правда после переезда ярлыки запуска Денвера пропадут и при старте системы он стартовать больше не будет. Спросите у знакомых ИТ-шников, что делать дальше.   
   
 Q. Изменяются ли файлы при заливке в Shimmie?   
 A. Нет, изменяется только имя файлов. Сам файл после сохранения из Shimmie через браузер побайтово эквивалентен исходному.   
   
 Q. Я уже рассортировал часть картинок. Мне теперь их заново сортировать?   
 A. Нет. При заливке картинок кучей, Shimmie автоматом даёт изображению тэги, соответствующие именам папок, в которых лежали изображения. Например, у вас была папка, которую вы добавляли и внутри папка to, а в ней изображение. Это изображение получит тэг to. Однако, следует учитывать, что если в имени папки имеются пробелы, всё, что между пробелами будет считаться отдельными тегами. Например, картинки в папке Lucky Star получат два тега -- Lucky и Star. А в папке Lucky\_Star -- один -- Lucky\_Star. Также избегайте папок, названия которых начинаются с минуса или содержат в себе минус после пробела.   
   
 Q. Что делать, если я забуду пароль от своего пользователя?   
 A. К сожалению, на текущий момент Shimmie не имеет механизма восстановления пароля. Однако, со стартовой страницы Денвера вы можете запустить "phpMyAdmin", найти в нём базу данных "shimmie", в ней таблицу "users" и удалить оттуда всех пользователей. Тогда новый зарегистрированный пользователь станет администратором и будет иметь доступ к картинкам. Если вы отключили регистрацию новых пользователей, то вам, кроме этого, придётся изменить значение опции "login\_signup\_enabled" из "N" в "Y" в таблице config. Разумеется, этим приёмом могут воспользоваться и злоумышленники.   
   
 Q. А я хочу главную страничку как во всяких боору, где девочки с циферками!   
 A. В "Extension manager" включите расширение "Home page", а в "Board config" поставьте в поле "Front page" вместо "/post/list" -- "home".   
   
 Q. А у меня  **очень**  много картинок, он выдержит?   
 A. Сайт "правило 34" (крупнейший на этом движке) содержит у себя более 800 тысяч картинок. Вы уверены, что у вас значительно больше? При числе картинок больше миллиона возможны побочные эффекты.   
   
     
    
 <https://diary.ru/~zHz00/p185851728_shimmie-kak-organajzer-kartinok.htm>   
   
 Теги:   
 [[Статьи]]   
 ID: p185851728