SHINSEKAI: Realization
======================

  
2022-01-06, 00:57  
 1 апреля 2013 года я  [написал](SHINSEKAI)  , что создаю секту, главой буду я, а священными текстами будет мой дневник.   
   
 Разумеется, я шутил. Но также я написал, что будет создан отдельный сайт со структурой и навигацией. Такого сайта я так и не создал, но я создал кое-что получше.   
   
 Итак, теперь у меня есть:   
 --  [Набор скриптов](https://github.com/zHz00/diary_ru_dump)  на питоне, позволяющих сделать локальную копию моего дневника   
 -- Или любого другого дневника, что, однако, не проверялось   
 -- Копия будет лежать в формате markdown с возможностью просмотра через  [Obsidian](https://obsidian.md/)  .   
 -- Перекрёстные ссылки по щелчку мыши, картинки, форматирование, полнотекстовый поиск, теги -- и всё это локально! Любая операция выполняется за пару секунд.   
  [(читать дальше)](https://zHz00.diary.ru/p221019785.htm?index=1#linkmore221019785m1)      
 -- Также я создал репозиторий на GitHub, который буду периодически обновлять (не каждый день). Так что если вы хотите локальную копию моего дневника, но не хотите разбираться со скриптами, её можно  [просто скачать](https://github.com/zHz00/zhz_diary_obsidian)  . Об'ём дневника вместе с картинками чуть больше 200 мегабайт. Также есть  [версия с онлайн-картинками](https://github.com/zHz00/zhz_diary_obsidian_nopics)  , она весит всего 12 мегабайт.   
 -- Если вы умеете использовать Git, то обновлять локальную копию можно будет автоматически, что, однако, потребует двукратного расхода пространства на диске из-за локального репозитория. Предупреждаю, что если у вас стоят расширения Гита для Проводника, то надо отключить в папке с дневником отображение статусов на иконках, иначе вы будете очень долго ждать, пока отобразятся все 6000 файлов.   
 Но есть недостатки:   
 -- Увы, с форматированием проблемы. Не поддерживается спойлер. Таблицы не поддерживают rowspan, colspan. Не работает выравнивание.   
 -- На текущий момент не скачиваются комментарии.   
 -- Просматривать записи в хронологическом порядке возможно только в Windows, и то, сначала придётся запустить скрипт update\_times.py . К сожалению, хорошего решения по данному вопросу у меня нет. Я могу вставить дату в имя файла, но тогда нельзя будет сортировать по имени записи, а это недопустимо. Сортировка по дате создания поддерживается только в Windows, потому что время создания файла фиксируется только в системах FAT/NTFS, а в системах ext2/3 не фиксируется. Тем не менее, время фиксируется в ext4 и некоторых других. Допилю эту функцию позже.   
   
 ![](https://i.imgur.com/gsVdz7b.png)   
 Почему я пришёл к такой модели? По трём причинам.   
   
 1. На дайари исторически, ещё с моего прихода в 2011 году, плохо работал поиск по сайту. Потом он перестал работать вообще. Приходилось искать через гугл по слову site:. Но это тоже работало не очень хорошо. После перехода на телеграм я воспрял духом, т.к. внутри телеграма поиск работал хорошо. Но искать я мог только в постах с 2017 года.   
   
 А ищу в своём дневнике я что-то постоянно. Для меня это важнейший источник той информации, которую я забыл. Локальная копия позволяет мне находить любой нужный пост за десять секунд.   
   
 2. Вторая причина -- я хотел консистентный бекап. До переезда дайари на новый движок была функция бекапа. Я ей периодически пользовался. Потом я стал постить в телеграм -- там есть экспорт. Последний бэкап произошёл позже, чем первая запись в телеграме, поэтому бэкап вроде как полный. Но а) он в двух частях б) с ним непонятно, как работать в) в телеграме есть пропуск в пару недель, когда автопостинг не работал, и вручную я тоже не постил. Эти посты есть только на дайари.   
   
 3. Отдельная история -- сохранение всех картинок. Картинки я всегда размещал на имедж-хостингах. Бог знает, сколько из них проебалось за десять лет. При этом хотя большинство картинок это рюшечки типа скриншотов из аниме, есть большое количество изображений, которые дополняют текст поста, или же являются его ключевой частью, как в случае тохо-реплеев из 2012 года.   
   
 Написав скрипт для скачивания картинок, я очень сильно удивился. Всего дневник сейчас содержит около 2000 картинок. Так вот, за 10 лет из них пропало всего-навсего 40 штук. 35 из них мне удалось восстановить при помощи детективных поисков на своих дисках. Несколько, увы, кануло в Лету. Предметом моей гордости является восстановление всех картинок в постах с тохо-реплеями.  [Взгляните](tags/Touhou.md)  .   
   
 Так вот, и тут я узнаю про Obsidian. Это программа для ведения заметок. Таких программ много, я вот длительное время работал с KeepNote, например. И он был лучшим из найденных, но он всегда очень сильно тормозил. Obsidian же летает, поддерживает все его функции, и даже больше. Как и KeepNote, он работает локально, а также сохраняет данные в plain text. Оба этих условия были для меня обязательными.   
   
 Посмотрим, как это выглядит. Слева панель с полным списком записей. Можно сортировать по дате (только под windows), по названию. Можно искать:   
   
   [![](https://e.radikal.host/2024/05/10/2e1488213baf.png)](https://radikal.host/i/flEfaI)     
   
 Вот экран с самой записью. Тут видно, как можно переходить по перекрёстным ссылкам:   
   
   [![](https://e.radikal.host/2024/05/10/530e1393c38f.png)](https://radikal.host/i/flE2Wg)     
   
 Самая крутая, хотя и не очень полезная фича -- облако записей. Оранжевым обозначены теги. Когда начинаешь лазить по всему этому, то кажется, что это не то паутина, не то плесень.   
   
   [![](https://e.radikal.host/2024/05/10/6b8d9d6dc691.png)](https://radikal.host/i/flEgvh)     
   
 По записям можно бродить, смотреть на связи, делать быстрый просмотр текста:   
   
   [![](https://e.radikal.host/2024/05/10/08b6824666bf.png)](https://radikal.host/i/flElsC)     
   
 Увы, граф записей был бы гораздо полезнее, если бы можно было подсветить в нём запись, на которую наведена мышка в любом другом окне. Пока я не нашёл, как это сделать. Кроме того. после просмотра записи нельзя легко вернуться к графу: он постоянно перестраивается, и всё оказывается в новых местах.   
   
 Будем надеяться, что авторы сделают эту крутую функцию удобнее.   
    
<https://diary.ru/~zHz00/p221019785_shinsekai-realization.htm>  
  
Теги:  
[[Программы]]  
[[Программирование]]  
ID: p221019785  


Комментарии: 14
---------------

  


---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (1/14) | 2022-01-06, 01:30 | CD\_Eater | c753425918 |

  
  Obsidian. Это программа для ведения заметок    
 он на электроне написан, там же JS внутри, как такое можно к себе установить? ))))   
 к тому же, софт с закрытыми исходниками   
 ^c753425918

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (2/14) | 2022-01-06, 02:08 | Xersareeth | c753425988 |

  
 Круто, но без каментов не щитово)   
   
 Сколько времени занимает полный дамп дневника?   
 А если пост был отредактирован между сканами, в локальном репе это отобразится?   
 ^c753425988

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (3/14) | 2022-01-06, 02:49 | zHz00 | c753426062 |

  
  [CD\_Eater](https://cd-eater.diary.ru "Записки ДискоЕда")  , о, очень интересная информация о том, как сделан обсидиан, спасибо. Исходники закрытые, это правда, меня это немного удивляет, т.к. обычно подобные проекты имеют открытый код. Тем не менее, это меня не беспокоит, т.к. все сведения в дневнике открытые, и я не беспокоюсь, что кто-то их украдёт. А значит проверять исходные коды нет необходимости. Предубеждения против закрытых кодов у меня нет.   
   
  [Xersareeth](https://BurrowDeclassified.diary.ru "One more fang")  , ДА, в некоторых постах комментарии важны, иногда важнее самого поста. Я буду думать над этой функцией, но пока хз как это удобно организовать.   
   
 Полный дамп текста занимает 3.5 часа при паузе между страницами в 1 минуту. Паузу можно сократить, но я не буду. Полный дамп картинок занимает 30+ часов при такой же паузе.   
   
 ДА, редактирования регистрируются, если делаешь полный повторный дамп, а потом проводишь остальную процедуру. Или надо заранее помнить, на каких примерно страницах, или с каким тегом были отредактированные посты, тогда можно сократить время, и сделать частичный дамп. Прошу ознакомиться с ридми.тхт в репозитории скриптов (diary\_ru\_dump)   
 ^c753426062

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (4/14) | 2022-01-06, 13:06 | himself | c753427148 |

  
  *К сожалению, хорошего решения по данному вопросу у меня нет.*    
 Отдельное оглавление.md? Или 2022\01.06-00:57\имя\_поста.md, а чтобы сортировать по имени, ищешь \* и сортируешь в результатах.   
 В линуксах ты также можешь сделать симлинки с названий 2022-01-06-00:57-имя\_поста.md на просто имя\_поста.md.   
 ^c753427148

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (5/14) | 2022-01-06, 13:23 | CD\_Eater | c753427242 |

  
  В линуксах ты также можешь сделать симлинки    
 сюрприз!   
 в винде тоже есть симлинки, и даже симлинки к директориям   
 ^c753427242

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (6/14) | 2022-01-06, 15:05 | zHz00 | c753427674 |

  
  [himself](https://himself.diary.ru "void")  , оооо, ОГЛАВЛЕНИЕ! Это супер-идея, спасибо!   
  [CD\_Eater](https://cd-eater.diary.ru "Записки ДискоЕда")  , расскажи про симлинки в винде.   
 ^c753427674

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (7/14) | 2022-01-06, 15:15 | Xersareeth | c753427720 |

  
 > в винде тоже есть симлинки, и даже симлинки к директориям   
 может быть в данном случае лучше подойдут хардлинки?)   
 ^c753427720

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (8/14) | 2022-01-06, 15:25 | zHz00 | c753427751 |

  
  [Xersareeth](https://BurrowDeclassified.diary.ru "One more fang")  , о, хардлинки NTFS поддерживает, действительно. Но при таком объёме данных (12 мегабайт на тексты; картинки же в любом случае хранятся в одном экземпляре) генерировать линки имхо вообще смысла нет, можно делать просто дубли файлов. Единственная причина -- это если хочешь синхронное редактирование. Но моя концепция подразумевает, что редактирование исходит от постов на дайари. Посты в локальном хранилище вообще не предназначены для редактирования.   
 ^c753427751

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (9/14) | 2022-01-06, 16:05 | CD\_Eater | c753427966 |

  
  расскажи про симлинки в винде.    
 про симлинки в винде расскажет консольная команда   
  **mklink /?**    
 ^c753427966

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (10/14) | 2022-01-06, 16:31 | zHz00 | c753428074 |

  
  [CD\_Eater](https://cd-eater.diary.ru "Записки ДискоЕда")  , ух ты, спасибо!   
 ^c753428074

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (11/14) | 2022-01-06, 17:05 | himself | c753428207 |

  
  [CD\_Eater](https://cd-eater.diary.ru "Записки ДискоЕда")  , виндовский хардлинк развалится при редактировании, симлинк не всех обманет, а джанкшн только для директорий. Линуксовый симлинк по опыту довольно крепок. На винде, внезапно, я бы сделал ярлыки может быть просто. Но если выбирать что-то одно, то коммитить в гит симлинки, а там как вычекаутит под виндой так вычекаутит.   
 ^c753428207

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (12/14) | 2022-01-06, 18:01 | Xersareeth | c753428436 |

  
  [himself](https://himself.diary.ru "void")  , вот это поворот! Я так понимаю, проблема в том, что редактор при сохранении создаёт новый файл и подменяет им старый? Но это же делает хардлинки практически бесполезными! ![:upset:](/picture/1154.gif)   
 ^c753428436

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (13/14) | 2022-01-06, 21:53 | CD\_Eater | c753429539 |

  
  виндовский хардлинк развалится при редактировании    
 а я и не предлагал использовать хардлинки ))   
   
  Линуксовый симлинк по опыту довольно крепок.    
 а виндовый некрепок? )))   
 извините, звучит как бред   
   
  коммитить в гит симлинки, а там как вычекаутит под виндой так вычекаутит.    
 а какие проблемы с гитом?   
 гит не резолвит симлинки ни при загрузке, ни при выгрузке   
 для него это просто обычные файлы, содержащие внутри себя какой-то текстовый путь   
 гит не пытается как-то интерпретировать содержание симлинка (т.е., он не лезет по указанному в симлинке пути)   
 думаю, в клиенте "гит для винды" симлинки обрабатываются примерно так же   
 самое страшное, что может случиться - винда при чекауте не даст создать симлинк, указывающий на несуществующий в системе путь )))   
 ^c753429539

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (14/14) | 2022-01-07, 00:39 | himself | c753430335 |

  
  [Xersareeth](https://BurrowDeclassified.diary.ru "One more fang")  , хотел сказать, что да, но попробовал двумя редакторами, и они хардлинк сохранили. И всё же я видел случаи, когда программа его ломала. Возможно, переименовывала старый файл в backup и создавала новый на его месте?   
 ^c753430335