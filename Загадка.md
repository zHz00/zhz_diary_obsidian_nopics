Загадка
========

   
 2011-11-17, 23:04   
  Сделал говнокод. Функционирует так, как мне надо. Попробуйте угадать, что он делает.   
   
 
```
sFmt.Format(\_T("%%.%de"),nDigits-1);  
sBuf.Format(\_T(sFmt), fValue);  
sscanf(sBuf,"%lf",&fValue);  
// шаманим-шаманим  
sFmt.Format(  
	\_T("%%.%df\t"),  
		(int)(fabs(fValue)>=pow((double)10,(int)(nDigits-1))?0:  
			(-1+nDigits-floor(fabs(fValue)**<**FLT\_MIN?-1+nDigits:  
				log10(fabs(fValue))))));  
sBuf.Format(\_T(sFmt),fValue);  
sItem += sBuf;
```
   
   
 Типы переменных:   
 sItem, sBuf, sFmt -- CString   
 fValue -- float   
 nDigits -- int   
   
 В принципе, этот кусок выполняется в цикле и на самом деле nDigits выбираются из массива типа aDigits[ix], а fValue в каждой итерации разный, потому что тоже выбран из массива, но это неважно.   
   
 Форматирование такое, потому что не хотел, чтобы за конец строки вылезало. Считайте меня Маяковским.   
   
 Ответ через трое суток. Не думаю, что кто-то захочет отписаться, но если такие найдутся, то ответ, пожалуйста, прячьте в тэг MORE, чтобы не подсказывать другим потенциальным желающим.   
  [(показать ответ)](https://zHz00.diary.ru/p169376440.htm?index=1#linkmore169376440m1)      
 Ответ:   
 Код добавляет (конкатенирует) к sItem число с заданным количеством значащих цифр, а вместо нуля добавляет "0". Исходное число содержится в sBuf, где оно и приводится к необходимому виду.     
   
 Можно ли было сделать проще?   
    
 <https://diary.ru/~zHz00/p169376440_zagadka.htm>   
   
 Теги:   
 [[Программирование]]   
 [[Говнокод]]   
 ID: p169376440