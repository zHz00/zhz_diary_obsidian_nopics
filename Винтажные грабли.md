Винтажные грабли
================

  
2020-03-05, 23:59  
 Детскую ошибку совершил:   
   
 a=a++;   
   
 Сначала было просто а++, потом я сделал a=(a+1)%4; и, наконец, решил вернуть как было, но промахнулся.   
   
 Долго думал, почему значение переменной в цилке не меняется. Даже когда увидел ошибку, понял не сразу.   
   
 У ++ приоритет меньше, чем у присваивания. Но это постфиксная форма. поэтому значением a++ в выражении будет старое значение a (в данном случае, ноль).   
   
 Выражение будет вычисляться следующим образом:   
 1. В качестве значения a++ берётся старое значение a (ноль).   
 2. a увеличивается на единицу (1).   
 3. a получает значение a++, которое равно нулю согласно пункту 1.   
   
 Таким образом, значение a дёрнулось, но после окончания вычислений вернулось обратно.   
  
<https://diary.ru/~zHz00/p219118775_vintazhnye-grabli.htm>  
  
Теги:  
[[Программирование]]  
[[Говнокод]]  
ID: p219118775  


Комментарии: 5
--------------

  


---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (1/5) | 2020-03-06, 12:01 | Disprein | c745947227 |

  
 Это undefined behavior, поскольку порядок действий 2 и 3 не определен стандартом.  [en.wikipedia.org/wiki/Undefined\_behavior#Exampl...](https://en.wikipedia.org/wiki/Undefined_behavior#Examples_in_C_and_C++)  ,  [en.cppreference.com/w/cpp/language/eval\_order](https://en.cppreference.com/w/cpp/language/eval_order)  .   
 ^c745947227

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (2/5) | 2020-03-06, 12:48 | Xersareeth | c745947836 |

  
 Что думаешь про a+=1?   
 ^c745947836

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (3/5) | 2020-03-06, 14:34 | zHz00 | c745949405 |

  
  [Disprein](http://disprein.diary.ru "Под грифом")  , воу! Про a++ + ++a знал, а про такое нет. Спасибо.   
  [LizardOfOzz](http://LizardsBurrow.diary.ru "One more night")  , а что с ним не так? Отношусь хорошо, никогда не использую.   
 ^c745949405

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (4/5) | 2020-03-06, 15:54 | korrshun | c745950533 |

  
  [zHz00](https://zHz00.diary.ru "Untitled")  , а я наоборот всегда предпочитал использовать эту форму.   
 // но это потому что в петоне/рубях/js нет ++ ^\_^', а не хочется переключать в голове синтаксисические конструкции.   
   
 ++ я юзал разве что в for, потому что слишком идиоматично и если я напишу там +=1, то могут возникнуть лишние вопросы.   
 ^c745950533

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (5/5) | 2020-03-06, 17:28 | Xersareeth | c745952100 |

  
  [zHz00](https://zHz00.diary.ru "Untitled")  , вот это с ним не так: «Отношусь хорошо, никогда не использую.» =)   
 ^c745952100