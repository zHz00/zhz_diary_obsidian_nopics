Где я обнаружил свой 2007-й
===========================

  
2023-11-30, 03:00  
 Во времена MS-DOS компьютер выключался кнопкой питания. Потом появился вин95. "Теперь питание компьютера можно отключить". Кто помнит эту оранжевую надпись?   
   
 Было известно на практике, что если неудачно выключить компьютер, то можно сломать систему. Потому что FAT32 резко реагировал, когда его прерывали на полуслове.   
   
 Потом эволюция шагнула вперёд. NTFS стал уделом не только серверов, но и всех домашних ПК. Снова стало можно выключать компьютер кнопкой питания, хотя мало кто так делал. И вот, настал 2023 год. У нас на работе на всех компах, которые идут клиентам вместе с приборами, стоит виндоуз 10. Как в ней обстоят дела с внезапными выключениями?   
   
 Пока я подключал кабеля к прибору, компьютер почему-то включился. У него ещё ни монитора, ни мышки. Ему ещё рано. Поэтому я просто нажал один раз на кнопку питания. И он выключился. Вроде всё нормально? Это же не жёсткое выключение при пятисекундном нажатии кнопки? И тем не менее.   
   
 При следующем включении он меня закинул в Windows Troubleshoot. При попытках перезагрузиться винда мне стала показывать экран о том, что BCD-файл не содержит упоминаний о валидных установках. Хорошо же. Я опять пошёл в траблшут, и выбрал там Startup Repair. Винда пошуршала винчестером, после чего сообщила, что починить ошибку не может. Подробности можно прочитать в файле: (на этом строка обрывалась, имени файла не было).   
   
 В общем, я оказался в ситуации, когда винда не грузится. Такого у меня не было много-много лет. Что я последний раз делал в такой ситуации? fdisk /mbr? scandisk.exe? Это всё давно отсутствует в составе винды.   
   
 В окне траблшутинга, хвала богам, был пункт "командная строка". И я его выбрал. И вот он я, а вот командная строка. Двое в комнате. Смогу же я починить загрузчик? Смогу?   
   
 bcdedit. Показал мне типовой бцд-файл, в нём было четыре раздела. Винда, траблшутинг, восстановление из гибернации и мемтест. Ничего особенного.   
   
 Может быть, файл winload.efi отсуствует? Перешёл в системную папку -- вот же он! Заодно убедился, что файловая система на месте и папки показываются. Уже хорошо.   
   
 sfc /scannow. "Операция не может быть завершена" или типа того.   
   
 chkdsk.exe c: . "Ошибки не обнаружены".   
   
 Хорошо же, лезу в интернет. Узнаю про замечательную программу, bootrec.   
   
 bootrec /fixmbr. Отработало, не помогло.   
 bootrec /fixboot. Отказано в доступе.   
 bootrec /scanos. Найдена одна система.   
 bootrec /rebuildbcd. The system cannot find the path specified.   
   
 У меня начинают закрадываться подозрения, что с системой что-то очень не так. Скорее всего, winload.efi повреждён, поэтому-то и не отрабатывает сфц, и поэтому файлы не найдены. Тем не менее, несмотря на таинственность последнего сообщения об ошибке, это было самое конкретное, чего я добился от винды за всё время. И я забил эту команду с сообщением в гугл. Среди результатов было двухминутное видео, которое содержало махинации с diskpart.exe, призванные изменить активный раздел. А заканчивалось видео незнакомой командой, bcdboot.   
   
 bcdboot c:\windows   
   
 Вот, что там было написано. Я не стал проводить манипуляции с дискпартом, потому что сомневался в том, что у меня проблемы с активностью раздела, а сразу запустил бцдбут. Он сообщил, что у него там какое-то дублирование, но загрузочный файл создал.   
   
 Я открыл bcdedit и обнаружил, что теперь файл выглядит иначе. Гибернация, мемтест и траблшут отсутствовали, но присутствовал windows boot manager, и в качестве загрузчика указан не winload.efi, а совершенно другой файл, имя которого я забыл. И файл этот работал. После перезагрузки винда стартовала.   
   
 Фактически, я починил компьютер вбивая в командную строку случайные команды по очереди.   
   
 Да, я достиг успеха, но успех этот мне не понравился. Я понял, что я плохо представляю процесс загрузки современного компьютера на виндоуз10, особенно с EFI. Я понял, что не знаком с современными средствами восстановления (хотя ими и воспользовался). Ну и ещё я понял, что теперь у меня в списке загрузки отсутствует траблшутинг! Надо бы его вернуть, но как? Я не уверен, что при появлении новых проблем траблшутинг найдёт себя сам и запустится...   
  
<https://diary.ru/~zHz00/p221828872_gde-ya-obnaruzhil-svoj-2007-j.htm>  
  
Теги:  
[[Борьба с техникой]]  
ID: p221828872  


Комментарии: 25
---------------

  


---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (1/25) | 2023-11-30, 09:45 | Филавандрель | c756306131 |

  
 я, конечно, понимаю, что это по феншую, вышеописанное, но оно надо? если даже там были файлы, подрубить хард к другому компу, скачать че надо, и накатить по новой винду   
 я чет уже давно не парюсь, свое время дороже   
 при этом я не помню, когда в последний раз вообще переустанавливал винду по причине плохой работы, хотя все топят за гейось   
 ^c756306131

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (2/25) | 2023-11-30, 10:02 | Kris Antari | c756306168 |

  
  Да, я достиг успеха, но успех этот мне не понравился. Я понял, что я плохо представляю процесс загрузки современного компьютера на виндоуз10, особенно с EFI. Я понял, что не знаком с современными средствами восстановления (хотя ими и воспользовался).   
    
   
 Типичные последствия взаимодействия с нормально работающей техникой. Если проблема возникает разово или исчезающе редко, навык решения этой проблемы не вырабатывается. У меня такое иногда случается с макосью: каждый раз, когда случается проблема, приходится гуглить, как её решить. При этом надобность в наладке маков после критического сбоя у меня случалась за 10 лет что с ними работаю, раза четыре (один на одной работе, один на другой и 2 раза на личном после экспериментов), что не способствовало глубокому изучению средств восстановления данных устройств. В остальное время эти компы просто работали. Думаю, винда скоро придёт (если не уже) к тому же.   
 ^c756306168

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (3/25) | 2023-11-30, 11:24 | zHz00 | c756306316 |

  
  [Филавандрель](https://lavi.diary.ru "Дорога без возврата")  , нет, накатить винду было не проще, потому что коллега, у которого флешка с виндой, унёс её с собой. Значит надо было делать новую, искать правильный дистрибутив. Плюс, нам для работ нужна не чистая винда, а со всякими установленными программами, которые пришлось бы ставить заново.   
   
 Есть ещё, конечно, переустановка без удаления, но я ей не пользовался со времён вин98 и не уверен, насколько она работоспособна сейчас.   
   
 Что за гейось?   
   
  [Kris Antari](https://Kris-Antari.diary.ru "Animus Vox")  ,   
 >>Если проблема возникает разово или исчезающе редко, навык решения этой проблемы не вырабатывается.   
   
 И это проблема. Похоже на ситуацию с пилотами самолётов, которых заставляют время от времени летать в ручном режиме, чтобы когда отказала автоматика они не оказались в неприятной ситуации.   
   
 >>Думаю, винда скоро придёт (если не уже) к тому же.   
   
 Она и пришла. Описанная ситуация довольно необычна для современной винды. Раньше такое случалось чаще.   
 ^c756306316

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (4/25) | 2023-11-30, 12:46 | Филавандрель | c756306506 |

  
  [zHz00](https://zHz00.diary.ru "Untitled")  ,  Что за гейось?  так вон, выше про нее есть коммент   
 ^c756306506

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (5/25) | 2023-11-30, 13:03 | zHz00 | c756306554 |

  
  [Филавандрель](https://lavi.diary.ru "Дорога без возврата")  , работа винды во многом зависит от режима эксплуатации. У меня одна установка живёт по 5+ лет, а это уже близко к сроку апгрейда компьютера. Досрочные сносы у меня бывали из-за отказа SSD и из-за восьмёрки на слабом железе, которую я откатил на семёрку. Причём сама система работала нормально. Ненормально работали дарк соулс 2. А под семёркой работали хорошо.   
 ^c756306554

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (6/25) | 2023-11-30, 13:38 | Филавандрель | c756306649 |

  
  [zHz00](https://zHz00.diary.ru "Untitled")  , аналогично, за исключением отказа ссд. страшная вещь   
 они, кстати, сразу умирают и нет вариантов спасти файлы?   
 ^c756306649

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (7/25) | 2023-11-30, 13:55 | Филавандрель | c756306695 |

  
  [Kris Antari](https://Kris-Antari.diary.ru "Animus Vox")  , умирают-то они сразу?   
 ^c756306695

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (8/25) | 2023-11-30, 14:03 | Kris Antari | c756306722 |

  
  [Филавандрель](https://lavi.diary.ru "Дорога без возврата")  , пардон, хотел отредактировать коммент и промахнулся кнопкой.   
 Дохнут они как-то очень внезапно. У меня ни одного случая не было, а вот у коллеги видел максимально наглядно: до обеда ноут работал, был оставлен на столе с видеомануалом на паузе, после обеда комп не работает, ССД мёртвый. Компу, если что, пол-года было, использовался как бытовой, ошибок или зависаний не выдавал, подозрений никаких не вызывал. Благо, бэкапы были, возможность поменять диск тоже была и второй диск тоже был, поставили систему на него. После этого я и заинтересовался, что нужно для восстановления данных и сколько это стоит. Получилось дорого и без гарантий, нахрен такое счастье.   
 ^c756306722

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (9/25) | 2023-11-30, 14:04 | Филавандрель | c756306731 |

  
  [Kris Antari](https://Kris-Antari.diary.ru "Animus Vox")  , короче ссд умирает моментально и без предупреждения? если так, надо будет озаботиться бекапом... а как правильно сделать бекап?   
 ну харды-то вроде мрут точно с предупреждением и можно успеть скопировать файлы? или тоже нет?   
 ^c756306731

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (10/25) | 2023-11-30, 14:10 | Kris Antari | c756306750 |

  
  [Филавандрель](https://lavi.diary.ru "Дорога без возврата")  , Лично я просто копирую на внешний хард то, что должно быть сохранено. Но у меня на компе порядок, поэтому Ctrl+C ->Ctrl+V с заменой файлов дубликатов не даёт. Если на компе бардак - лучше использовать спецсофт. На маках он идёт из коробки, Time Mashine называется, на рабочих компах использую его, потому что восстанавливает не только файлы, но и все настройки и приложения, которые были на момент бэкапа, что страхует от кривых рук некоторых товарищей. На винду - не подскажу, ибо сталкиваюсь с ней не особо часто.   
 ^c756306750

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (11/25) | 2023-11-30, 15:54 | Филавандрель | c756307096 |

  
  [Kris Antari](https://Kris-Antari.diary.ru "Animus Vox")  , как же впадлу это делать, инфы дофига и все нужно. ладно, спасибо за инфу   
 ^c756307096

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (12/25) | 2023-11-30, 15:59 | Марц | c756307107 |

  
 Могу предложить поставить утилиту, отслежтвающую параметры SMART, как минимум, она подскажет что пора делать бэкапы.   
 ^c756307107

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (13/25) | 2023-11-30, 16:15 | Филавандрель | c756307142 |

  
 например какую?   
 ^c756307142

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (14/25) | 2023-11-30, 16:58 | Марц | c756307269 |

  
 я использую CrystalDiskInfo   
 ^c756307269

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (15/25) | 2023-11-30, 17:58 | zHz00 | c756307461 |

  
  [Филавандрель](https://lavi.diary.ru "Дорога без возврата")  , у меня ссд умирал плавно. Спустя буквально полгода эксплуатации неожиданно обнаружил в системных логах постоянные ошибки диска. Расследование показало, что ошибки были именно на ссд. Новый купил, хули. Личные файлы на системной диске почти не хранил и не храню. Так что много данных забирать не пришлось.   
   
 Но хорошо, что вы все напомнили, я вспомнил кое-что ценное, что надо перенести с ссд.   
 ^c756307461

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (16/25) | 2023-11-30, 18:07 | Филавандрель | c756307483 |

  
  [Марц](https://906.diary.ru "Дневник")  , а у меня такая кстати есть. решил запустить, а там...   
   
 ![](https://diary.ru/resize/-/-/4/9/3/9/493996/bk5TG.jpg)   
   
 Так-то это просто хард обычный, где у меня офлайн игрушки, которые не требуют ССД. Если умрет, то пофигу так-то.   
   
 Вот я вижу такое сообщение, и что мне делать?))   
 ^c756307483

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (17/25) | 2023-11-30, 18:10 | Филавандрель | c756307491 |

  
  [zHz00](https://zHz00.diary.ru "Untitled")  , у меня на системном ссд программы всякие для которых нужно быстродействие, тот же обс для стримов. если грохнется, ох как я заколебусь обс снова настраивать. это самое страшное   
 ^c756307491

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (18/25) | 2023-11-30, 18:11 | zHz00 | c756307494 |

  
  [Филавандрель](https://lavi.diary.ru "Дорога без возврата")  , главный показатель -- переназначенные сектора. У тебя он равен нулю (правая колонка). Нестабильные и неисправимые это, конечно, плоховато, но значит в переназначенные они так и не перешли. С чем связано, не знаю. Скорее всего, с записью в момент аварийных выключений, которых было больше 30 штук (22). Думаю, что можно пользоваться.   
 ^c756307494

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (19/25) | 2023-11-30, 18:11 | Марц | c756307499 |

  
 я бы советовал делать бэкап как C6 начнёт расти   
 ^c756307499

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (20/25) | 2023-11-30, 19:04 | Филавандрель | c756307696 |

  
 понял, спасибо. проверку диска имеет смысл делать? чтобы там фциговые кластеры обозначить чтобы их не использовали. типа диск там станет более маленького объема, но будут использоваться только правильные кластеры)   
 ^c756307696

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (21/25) | 2023-11-30, 19:21 | Марц | c756307752 |

  
  [Филавандрель](https://lavi.diary.ru "Дорога без возврата")  , нет ничего плохого в том, чтобы сделать чекдиск :3   
 ^c756307752

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (22/25) | 2023-11-30, 19:25 | Филавандрель | c756307770 |

  
 ок))   
 ^c756307770

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (23/25) | 2023-12-01, 00:52 | Филавандрель | c756308904 |

  
 еще вопрос. имеет смысл хард через викторию прогонять, чтобы ремапить или игнорить убитые кластеры? или встроенный чекдиск винды это делает? потому что он сказал, что все в норме. но он чет как-то быстро сделал, а виктория долго дрочит каждый кластер. на несколько часов забава. походу стоит, да?)   
 ^c756308904

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (24/25) | 2023-12-01, 09:06 | Марц | c756309353 |

  
  [Филавандрель](https://lavi.diary.ru "Дорога без возврата")  , без параметров chkdsk только фс проверил, можно викторией, можно chkdsk /F /R   
 ^c756309353

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (25/25) | 2023-12-01, 09:10 | Филавандрель | c756309361 |

  
  [Марц](https://906.diary.ru "Дневник")  , понял, речь шла о командной строке)   
 ^c756309361