Записи на diary.ru и AJAX для анонимусов
=========================================

   
 2016-07-25, 22:20   
  Выяснилась интересная подробность. По жалобам анонимных читателей удалось установить следующее:   
   
 если пользователь, открывающий дайари-ру, не залогинен, то у него подгружается версия постов без ява-скриптов, повешенных на ссылки тега MORE (то, что "под катом"). А если пользователь залогинен -- то там есть OnClick, который вызывает подгрузку содержимого MORE без перезагрузки страницы.   
   
 Это ведёт к тому, что для анонимусов клики по MORE типа "читать дальше" и пр., приводят к загрузке поста заново, при этом грузится он с параметром ?oam, что означает "open all more". Т.е. открываются ВСЕ каты сразу -- и вложенные, и последовательные. Никаких промежуточных версий, когда открыт только второй кат, или только кат внешнего уровня, для анонимусов нету.   
   
 Признаться, я на это не рассчитывал (хотя старался делать так, чтобы пост со всеми раскрытыми морами выглядел адекватно и связно).   
   
 Приношу извинения всем анонимусам, которые узнали какие-либо спойлеры по культурным произведениям из-за автоматического открытия тех моров, которые они открывать не собирались.   
    
 <https://diary.ru/~zHz00/p209897160_zapisi-na-diary-ru-i-ajax-dlya-anonimusov.htm>   
   
 Теги:   
 [[Борьба с техникой]]   
 ID: p209897160