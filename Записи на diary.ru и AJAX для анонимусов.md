Записи на diary.ru и AJAX для анонимусов
========================================

  
2016-07-25, 22:20  
 Выяснилась интересная подробность. По жалобам анонимных читателей удалось установить следующее:   
   
 если пользователь, открывающий дайари-ру, не залогинен, то у него подгружается версия постов без ява-скриптов, повешенных на ссылки тега MORE (то, что "под катом"). А если пользователь залогинен -- то там есть OnClick, который вызывает подгрузку содержимого MORE без перезагрузки страницы.   
   
 Это ведёт к тому, что для анонимусов клики по MORE типа "читать дальше" и пр., приводят к загрузке поста заново, при этом грузится он с параметром ?oam, что означает "open all more". Т.е. открываются ВСЕ каты сразу -- и вложенные, и последовательные. Никаких промежуточных версий, когда открыт только второй кат, или только кат внешнего уровня, для анонимусов нету.   
   
 Признаться, я на это не рассчитывал (хотя старался делать так, чтобы пост со всеми раскрытыми морами выглядел адекватно и связно).   
   
 Приношу извинения всем анонимусам, которые узнали какие-либо спойлеры по культурным произведениям из-за автоматического открытия тех моров, которые они открывать не собирались.   
  
<https://diary.ru/~zHz00/p209897160_zapisi-na-diary-ru-i-ajax-dlya-anonimusov.htm>  
  
Теги:  
[[Борьба с техникой]]  
ID: p209897160  


Комментарии: 5
--------------

  


---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (1/5) | 2016-07-25, 23:15 | Crawling Chaos | c710130659 |

  
 Боюсь такого простить они смогут...   
 ^c710130659

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (2/5) | 2016-07-25, 23:19 | Heyzer | c710130887 |

  
 Будут выть под окнами по ночам...   
 ^c710130887

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (3/5) | 2016-07-27, 14:41 | himself | c710195702 |

  
 Да, есть такая фигня, и давно. Когда писал экспорт в RSS, с ней сталкивался. Кажется, в настройках пользователя можно выбрать этот режим и для залогиненных пользователей (там три).   
 ^c710195702

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (4/5) | 2016-07-27, 14:53 | zHz00 | c710196139 |

  
 "этот режим" -- отключённый аякс?   
 ^c710196139

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (5/5) | 2016-07-27, 16:18 | himself | c710199207 |

  
 Да, там 3 варианта:   
 \* скрытая часть грузится одновременно со страницей   
 \* скрытая часть подгружается динамически при клике на MORE   
 \* клик на MORE открывает страницу с комментариями, где содержимое MORE в записи всегда открыто   
 ^c710199207