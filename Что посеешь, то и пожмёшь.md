Что посеешь, то и пожмёшь
==========================

   
 2017-02-15, 23:58   
  Одним проектом я не занимался год. Потом открыл. Ох, как всё запущенно.   
   
 Я знал и знаю некоторые правила хорошего стиля программирования, которые я сам иногда нарушаю. И открыв этот проект я огрёб по полной. Я не знаю, почему я тогда нарушил парочку базовых правил, но сейчас мне это сильно добавило работы. Правила все давно знают, но всё же их укажу:   
   
 1. У переменных должны быть понятные имена. Это касается не только переменных типа \_, asdbsd и Burrrrp (хотя игроку в НетХак последняя будет весьма понятна) -- тут всё ясно. Название может иметь отношение к реальной ситуации, но имеет шанс быть воспринятым неправильно. Так, у меня в программе была переменная по имени need\_count. Я долго думал, что это число раз, которые надо (need) посчитать (count) что-то. Однако на самом деле эта переменна обозначало то, НАДО считать (1) или НЕ НАДО (0).   
   
 2. Отсюда вытекает второе правило -- тип переменной должен соответствовать её назначению. Переменная из п.1 имела тип int. Хотя гораздо понятнее всё было бы, если бы я сделал её типа \_Bool (это было в той части проекта, которая работала на микроконтроллере, а она написана на голом Си-99, поэтому именно \_Bool, а не bool). Для МК, это, правда, простительно, т.к. int будет быстрее обрабатываться в ряде случаев.   
 Примечание. Беззнаковые типы при совместном использовании со знаковыми таят в себе гремучую бомбу:  [zhz00.diary.ru/p211118163.htm](Зазеркалье)    
   
 3. А третье правило -- не следует повторно использовать ту же переменную для других целей. Хотя для переменных типа x, y, i особой разницы нету, сколько раз их использовать. Но повторное использование более специальных переменных часто ведёт к нарушению п.1. То, на чём конкретно напоролся я -- WriteFile возвращает через указатель число записанных байтов. Для этого я использовал переменную с подходящим именем written. Но потом мне надо было читать данные при помощи ReadFile. Как не трудно догадаться, он тоже через указатель возвращает число байтов, но уже прочтённых. Видимо тогда я решил сэкономить четыре байта. Ну вот нафига? Да-да, именно так. Я написал --   
   
 ReadFile(hFile,size,&written,NULL);   
   
 Потом очень удивился -- зачем я после чтения проверяю число записанных байт?.. Это уже было в части программы для ПК, так что тут прощения мне нет -- под ПК экономить нечего.   
   
 Это я тогда был не в своём уме или так вырос за год, что считаю дикостью то, что сделал своими же руками?   
   
 Но кое-от-чего чего я пока избавиться не смог -- так это от применения операции ?: . Очень её люблю, хотя она сильно усложняет чтение текста.   
    
 <https://diary.ru/~zHz00/p211994243_chto-poseesh-to-i-pozhmyosh.htm>   
   
 Теги:   
 [[Программирование]]   
 [[Говнокод]]   
 [[Очевидное-невероятное]]   
 ID: p211994243