Об отладке движущихся железок
=============================

  
2019-04-10, 23:30  
 Каков обычный подход к отладке? Запускаем, потом смотрим, что получается. Если получается не то, что надо, то разбираемся в оставшихся ошмётках, пытаясь по ним определить, что произошло.   
   
 Если отлаживается ПО, которое двигает брутальными рычагами при помощи киловаттных двигателей, то такой метод не подходит. Хорошо, если дело обойдётся заделыванием дыры в стене.   
   
 В текущей установке цена не столь высока, но риск что-нибудь поломать -- реальный. Поэтому приходится при отладке максимально увеличивать безопасность всех действий. Хотя с движущимися железками я имел дело и до этого, но они всегда были довольно маленькими. По большим железкам -- я начинающий. Если у вас есть опыт такой отладки -- прошу поделиться советами.   
   
 Вот что я придумал, пока пытался ничего не сломать:   
 1. Точки останова и интерактивную отладку вообще следует использовать с большой осторожностью. Пока программа остановлена, движущиеся части могут продолжать двигаться. Поэтому точки надо ставить ПОСЛЕ команд, которые всё останавливают, а не до. Важно помнить, что если точка стоит на строчке с командой Stop(), то команда выполнена не будет! Надо ставить на следующей строке. Если вам нужно поставить точку там, где нет тотальной остановки, её надо туда временно добавить.   
 2. Тем не менее, запускать весь алгоритм целиком -- опасно. Тут есть два метода:   
 а) Алгоритм надо разбить на отдельные этапы, между которыми программа будет вставать на паузу, а все движущиеся части останавливаться. По кнопке программа должна выполнять следующий кусок, если предыдущий прошёл успешно. А если нет -- как раз в этот момент можно будет покопаться в памяти при помощи интерактивного отладчика. Таким образом отладка будет состоять не из серии прогонов и разборов полётов, а из серий прогонов кусков 1, 1+2, 1+2+3 и т.д.   
 б) Начальные точки движения частей надо расположить подальше от препятствий, а диапазоны перемещений сделать маленькими, поэтому даже если система поедет не туда, она ничего не вывернет.   
 3. Отладка должна вестись одной рукой. Вторую надо держать на выключателе, который всё обесточивает (система должна быть разработана так, чтобы при пропадании питания по инерции ничего не ехало, но это задача не программиста; ещё одна задача не программиста -- минимизировать риск столкновения частей при штатной работе, например механически ограничить зоны деятельности разных деталей так, чтобы они никогда не пересекались).   
 4. Во время правки кода система должна быть выключена, а программа не должна выполняться, т.к. пока код не отлажен, что-то может поехать, пока вы отвернулись и уткнулись в монитор. У меня так поехало, причём я до сих пор не знаю, когда поехало и почему.   
 5. Удобство интерфейса отладочной многокнопочной утилиты (или что вы там используете) очень важно. Чем понятнее для вас всё сделано, тем меньше шанс по ошибке нажать не ту кнопку. Очевидно, что надо перед нажатием чего бы то ни было вообще по два раза проверять, что вы нажимаете. Непонятное расположение кнопок, двусмысленные надписи, разные единицы измерения в разных полях ввода -- это всё очень опасно.   
 6. Выдавать окошечки с кнопкой ОК для информирования вас о чём-либо -- плохая идея. Они перекрывают главное окно, а могут вообще его блокировать. Таким образом, вы теряете контроль над установкой.   
 7. Отдельного трактата достойна обработка исключительных ситуаций. Это дело я пока вообще только обдумываю. Например, управляющая программа может УПАСТЬ, а любые подчинённые микроконтроллеры -- зависнуть или умереть. Какие части будут продолжать двигаться после этого? Насколько долго? Сколько промасленных котов намотает на вал? Как можно от этого защититься?   
   
 Меня утешает, что тем, кто пишет ПО для спутников, приходится гораздо хуже.   
  
<https://diary.ru/~zHz00/p217487865_ob-otladke-dvizhuwihsya-zhelezok.htm>  
  
Теги:  
[[Программирование]]  
[[Борьба с техникой]]  
[[Статьи]]  
ID: p217487865  


Комментарии: 8
--------------

  


---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (1/8) | 2019-04-11, 07:06 | Heavy Rain | c739861565 |

  
 а в РнД нашлась работа?   
 ^c739861565

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (2/8) | 2019-04-11, 07:35 | zHz00 | c739861705 |

  
  [Heavy Rain](http://kogacz.diary.ru "dear j ournal")  , я в командировке же. Работаю.   
 ^c739861705

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (3/8) | 2019-04-11, 07:48 | Heavy Rain | c739861799 |

  
  [zHz00](https://zHz00.diary.ru "Untitled")  , а. вот тебя за что туда сослали.   
 ^c739861799

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (4/8) | 2019-04-11, 08:27 | zHz00 | c739862094 |

  
  [Heavy Rain](http://kogacz.diary.ru "dear j ournal")  , и за что?!   
 ^c739862094

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (5/8) | 2019-04-11, 09:06 | Heavy Rain | c739862533 |

  
  [zHz00](https://zHz00.diary.ru "Untitled")  , ну по работе в смысле. это какая-то долгая командировка, что аж с проживанием?   
 ^c739862533

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (6/8) | 2019-04-11, 22:17 | zHz00 | c739877298 |

  
  [Heavy Rain](http://kogacz.diary.ru "dear j ournal")  , уж вторую неделю установку налаживаю. А могу и на месяц застрять. В целях экономии сняли с коллегами квартиру.   
 ^c739877298

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (7/8) | 2019-04-13, 06:50 | Гость | c739901620 |

  
 Наладка шагающего боевого робота?   
 ^c739901620

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (8/8) | 2019-04-13, 08:50 | zHz00 | c739902159 |

  
  **Гость**  , робот есть, но его, хвала богам, налаживаю не я.   
 ^c739902159