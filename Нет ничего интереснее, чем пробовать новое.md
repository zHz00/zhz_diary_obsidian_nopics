Нет ничего интереснее, чем пробовать новое
==========================================

  
2019-05-09, 23:59  
 В серьёзных проектах со сжатыми сроками надо стараться использовать методы, которые принесут поменьше сюрпризов. То есть, методы хорошо знакомые и проверенные. Но это не всегда получается. А иногда можно было бы воспользоваться известным методом, но что-то зачесалось и потянуло на эксперименты. Не надо так.   
   
 Задача была простая -- в начале выполнения программы удалить файл. Как это сделать? Можно было бы сделать system("del file.txt"). А можно было бы воспользоваться простой советской функцией Win32 API -- DeleteFile. Но я вспомнил, что буквально на днях видел класс CFile. И там была статическая функция, которая удаляет файл.   
   
 Ничтоже сумняшеся я написал CFile::Remove("file.txt") и успокоился. Первый раз сработала, второй раз сработала. А на третий я сделал перезапуск особым образом -- и произошла ситуация, при которой файла уже не было. Что же сделала эта функция, не обнаружив удаляющегося файла? Подсказка: функция оказалась типа void.   
   
 Она вывела на экран диалоговое окно! В котором сообщила, что файла, который я хочу удалить, нету. Ну спасибо.   
   
 У меня программа должна всё автоматически делать, а тут она повисла и ждёт, пока кто-нибудь закроет окно. А... как вообще предполагалось, что программа узнает, что удалить файл не удалось? Для каких же целей подойдёт эта функция? И для каких целей её делали разработчики?   
   
 В общем, не рекомендую.   
  
<https://diary.ru/~zHz00/p217642989_net-nichego-interesnee-chem-probovat-novoe.htm>  
  
Теги:  
[[Программы]]  
[[Борьба с техникой]]  
ID: p217642989  


Комментарии: 3
--------------

  


---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (1/3) | 2019-05-10, 12:01 | roadischosen | c740443193 |

  
 Судя по  [документации](https://docs.microsoft.com/ru-ru/cpp/mfc/reference/cfile-class?view=vs-2019#remove)  , функция кидает exception в случае неудачи. Кто-то сделал глобальный обработчик для дебага и забыл сказать/удалить/и т.д.?   
 ^c740443193

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (2/3) | 2019-05-10, 12:03 | Xersareeth | c740443214 |

  
 Открыл первую попавшуюся доку: «Если удалить файл невозможно, например, из-за неправильно указанного имени файла, то метод вызывает исключение.» А какое именно исключение - не написано, что характерно))   
   
 А вообще очень странное поведение, да. Ещё можно в модальном окне спросить у пользователя какой другой файл он хочет удалить, раз этого не нашлось, не давая возможности отказаться. ![:laugh:](http://static.diary.ru/picture/1126.gif)   
 ^c740443214

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (3/3) | 2019-05-10, 23:00 | zHz00 | c740455974 |

  
  [roadischosen](http://roadischosen.diary.ru "Ugh")  ,  [LizardOfOzz](http://LizardsBurrow.diary.ru "One more night")  , а, так вот оно в чём дело, Михалыч! Спасибо. Вот к чему приводит невнимательное чтение документации.   
 ^c740455974