Похапэ
======

  
2012-03-11, 22:02  
 Надо было написать крохотный парсер. Получилось вот что:   
 
```
  
if(!(strpos(strtolower($iterator),"http://..............................")===FALSE)) // проверка адреса страницы на соответствие шаблону
	{
		$data=@file_get_contents($iterator);
		$s=str_replace(' ','_',$data);
		$s=strtolower($s);
		$key="<li>Original: <a href=\"";
		$key2="\"";
		$b=strpos($data,$key)+strlen($key);
		$e=strpos($data,$key2,$b+1);
		if(($b===FALSE)||($e===FALSE))
			return;
		$url=substr($data,$b,$e-$b);
		mb_echo(" $b $e $url\n"); // отладочная печать
		mb_echo("\n[send_to_download]starting thread"); // отладочная печать
		mb_SysBeginThread('download_file', $cid."\n".$url."\n".$fsize."\n".$iterator."\n".$r);	// начало потока с загрузкой файла
	}  

```
   
 Мне сказали: "Ох... PHP плохо адаптирован для анализа текста, нужен пёрл".   
   
 Ну, выбора, что использовать, у меня не было. Хотя похапэ я знаю плохо, несмотря на его огромный "C-like". Постоянно путаю порядок параметров в функциях, потом полчаса ищу ошибку.   
  
<https://diary.ru/~zHz00/p173954624_pohapje.htm>  
  
Теги:  
[[Программирование]]  
[[Говнокод]]  
ID: p173954624  


Комментарии: 2
--------------

  


---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (1/2) | 2012-03-13, 15:41 | Гость | c589963191 |

  
  $s=strtolower($s); $key="<li>Original: <a href=\""; $b=strpos($data,$key)+strlen($key);   
 Мне только кажется или ты действительно ищешь подстроку  **O**  riginal в строке, над которой поработала strtolower? Оно работает?   
   
 // ssvda   
 ^c589963191

---



|         #         |              Дата              |                     Автор                     |           ID           |
| --- | --- | --- | --- |
| (2/2) | 2012-03-13, 18:57 | Гость | c589987262 |

  
 Нет. Я ступил. Я вообще не понимаю зачем делать   
 $s=str\_replace(' ','\_',$data);$s=strtolower($s); в цикле, если оно там не используется.   
 ^c589987262